import{a as w}from"./chunk-2LGJXZ3K.js";import"./chunk-XQFBF7XZ.js";import"./chunk-F5AVIJ4I.js";import{b as U,h as E,j as y,k as j,l as C}from"./chunk-LOSME26X.js";import{Ca as I,J as l,L as u,N as g,R as d,U as p,V as n,W as s,X as v,b as f,ca as h,j as b,la as a,pa as S,q as T,qa as _,za as x}from"./chunk-IJPQUT22.js";import"./chunk-4WFVMWDK.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-ES7SHQTL.js";import"./chunk-ABTDBHFV.js";import"./chunk-5Y22IS3P.js";import"./chunk-CFCTAWCC.js";import"./chunk-UQSJFG5S.js";import"./chunk-LRFGNCHE.js";import"./chunk-M2X7KQLB.js";import"./chunk-GIP4FLTX.js";import"./chunk-42C7ZIID.js";import"./chunk-OZYWYLNK.js";import{f as k}from"./chunk-D7YYRZS5.js";var m=class{constructor(t,o,e,i,c){this.id=t,this.nombre=o,this.descripcion=e,this.precio=i,this.usuario=c}toString(){return`${this.nombre} - ${this.descripcion} - $${this.precio}`+(this.usuario?` - Usuario: ${this.usuario.nombre}`:"")}};var F=(()=>{let t=class t{constructor(){this.tickets=[],this.ticketsSubject=new f([])}getTickets(){return this.ticketsSubject.asObservable()}addTicket(e){return this.tickets.push(e),this.ticketsSubject.next(this.tickets),b(e)}sendTickets(){console.log("Tickets enviados:",this.tickets),this.tickets=[],this.ticketsSubject.next(this.tickets)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=T({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();function P(r,t){if(r&1&&(n(0,"ion-item")(1,"ion-label"),a(2),s()()),r&2){let o=t.$implicit;l(2),_(" ",o.nombre," - ",o.descripcion," - ",o.precio," puntos - Usuario: ",(o.usuario==null?null:o.usuario.nombre)||"N/A"," ")}}function A(r,t){if(r&1&&(n(0,"ion-item")(1,"ion-label"),a(2),s()()),r&2){let o=t.$implicit;l(2),S(" ",o.nombre," - ",o.email," - ",o.puntos||0," puntos ")}}var G=(()=>{let t=class t{constructor(e,i){this.ticketService=e,this.userService=i,this.tickets=[],this.users=[]}ngOnInit(){this.loadTickets(),this.loadUsers()}loadTickets(){this.ticketService.getTickets().subscribe({next:e=>this.tickets=e,error:e=>console.error("Error al cargar tickets",e)})}addTestTicket(){if(this.users.length===0)return;let e=new m(this.tickets.length+1,"Ticket de prueba","Descripci\xF3n de prueba",50,this.users[0]);this.ticketService.addTicket(e).subscribe({next:()=>this.loadTickets(),error:i=>console.error("Error al crear ticket",i)})}loadUsers(){this.userService.getAllUsers().subscribe({next:e=>{this.users=e.map(i=>({uid:i.uid,nombre:i.data.name||"Sin nombre",email:i.data.email||"Sin email",puntos:i.data.points||0}))},error:e=>console.error("Error al cargar usuarios",e)})}addTestUser(){return k(this,null,function*(){let e="usuarioTest_"+new Date().getTime(),i={favorites:[],points:0,tips:[],email:"test@correo.com",name:"Usuario Test"};try{yield this.userService.createUser(e,i),console.log("Usuario creado correctamente"),this.loadUsers()}catch(c){console.error("Error al crear usuario",c)}})}};t.\u0275fac=function(i){return new(i||t)(u(F),u(w))},t.\u0275cmp=g({type:t,selectors:[["app-points"]],decls:14,vars:2,consts:[[1,"ion-padding"],["expand","block","color","primary",3,"click"],[4,"ngFor","ngForOf"],[2,"margin","20px 0"]],template:function(i,c){i&1&&(n(0,"ion-content",0)(1,"h2"),a(2,"Historial de Tickets"),s(),n(3,"ion-button",1),h("click",function(){return c.addTestTicket()}),a(4," Agregar Ticket de Prueba "),s(),n(5,"ion-list"),d(6,P,3,4,"ion-item",2),s(),v(7,"hr",3),n(8,"h2"),a(9,"Usuarios desde Backend"),s(),n(10,"ion-button",1),h("click",function(){return c.addTestUser()}),a(11," Agregar usuario de prueba "),s(),n(12,"ion-list"),d(13,A,3,3,"ion-item",2),s()()),i&2&&(l(6),p("ngForOf",c.tickets),l(7),p("ngForOf",c.users))},dependencies:[I,x,E,C,y,j,U],encapsulation:2});let r=t;return r})();export{G as PointsComponent};
